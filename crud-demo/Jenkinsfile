#!groovy

env.PATH_PROJECT='crud-demo/'

node("ec2_node") {
	deleteDir()
	
	stage('Descargar fuentes') {
		checkout scm
	}
	
        stage('Pruebas unitarias') {
                script {
                    sh "cd ${PATH_PROJECT} && ./mvnw -f pom.xml test"
            	}
        }

       stage('Compilar aplicación') {
                script {
                	sh "cd ${PATH_PROJECT} && ./mvnw -f pom.xml package -DskipTests"
                }
        }
	
	stage('Desplegar aplicación') {
		script {
			sh "cd ${PATH_PROJECT} && docker-compose up -d docker-compose.yml"
		}
	}
}
